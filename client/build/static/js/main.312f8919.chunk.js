(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{44:function(e,t,a){e.exports=a(60)},49:function(e,t,a){},50:function(e,t,a){},55:function(e,t,a){},56:function(e,t,a){},60:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(30),s=a.n(l),o=a(17),c=(a(49),a(50),a(51),a(16)),i=a(8),u=a(9),h=a(11),m=a(10),p=a(12),d=a(41),v=a(25),f=a.n(v),b=a(31),E=a(13),y=a(61),C=a(62),g=a(63),O=function(e){return r.a.createElement("div",{className:"form-group"},r.a.createElement(C.a,null,e.title),r.a.createElement(g.a,{type:e.type,id:e.name,name:e.name,value:e.value,placeholder:e.placeholder,onChange:e.handleChange}),e.errors&&e.errors[e.name]&&r.a.createElement(g.a.Feedback,null,e.errors[e.name].map((function(t,a){return r.a.createElement("div",{key:"field-error-".concat(e.name,"-").concat(a),className:"fieldError"},t)}))))},j=function(e){function t(){return Object(i.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.options.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name)}));return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:this.props.name}," ",this.props.title," "),r.a.createElement("select",{id:this.props.name,name:this.props.name,value:this.props.value,onChange:this.props.handleChange,className:"form-control"},r.a.createElement("option",{value:"",disabled:!0},this.props.placeholder),e))}}]),t}(r.a.Component),w=function(e){function t(){return Object(i.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.options.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name)}));return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{for:this.props.name}," ",this.props.title," "),r.a.createElement("select",{id:this.props.name,name:this.props.name,value:this.props.value,onChange:this.props.handleChange,className:"form-control"},r.a.createElement("option",{value:"",disabled:!0},this.props.placseholder),e))}}]),t}(r.a.Component),T=function(e){return console.log(e.style),r.a.createElement("button",{style:e.style,className:"primary"===e.type?"btn btn-primary":"btn btn-secondary",onClick:e.action},e.title)},S=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).setValue=function(e,t,n){return"string"==typeof t?a.setValue(e,t.split("."),n):1===t.length&&void 0!==n?a.setState({obj:e[t[0]]=n}):0===t.length?e:a.setValue(e[t[0]],t.slice(1),n)},a.state={countries:[],provinces:[],errors:[],newCoop:{name:"",types:[{name:""}],address:{formatted:"",locality:{name:"",postal_code:"",state:""},country:t.DEFAULT_COUNTRY},enabled:!0,email:"",phone:"",web_site:""}},a.handleFormSubmit=a.handleFormSubmit.bind(Object(E.a)(a)),a.handleClearForm=a.handleClearForm.bind(Object(E.a)(a)),a.handleInput=a.handleInput.bind(Object(E.a)(a)),a.handleTypeChange=a.handleTypeChange.bind(Object(E.a)(a)),a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"handleFormSubmit",value:function(){var e=Object(b.a)(f.a.mark((function e(a){var n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),delete this.state.newCoop.address.country,e.prev=3,console.log("proxy: "+t.REACT_APP_PROXY),e.next=7,fetch(t.REACT_APP_PROXY+"/coops/",{method:"POST",body:JSON.stringify(this.state.newCoop),headers:{Accept:"application/json","Content-Type":"application/json"}});case 7:if(!(n=e.sent).ok){e.next=15;break}return e.next=11,n.json();case 11:return r=e.sent,window.flash("Record has been created successfully!","success"),this.handleClearForm(),e.abrupt("return",r);case 15:return e.next=17,n.json();case 17:throw e.sent;case 20:e.prev=20,e.t0=e.catch(3),console.log("_error_: ",e.t0),this.setState({errors:e.t0});case 24:case"end":return e.stop()}}),e,this,[[3,20]])})));return function(t){return e.apply(this,arguments)}}()},{key:"handleClearForm",value:function(){}},{key:"handleInput",value:function(e){var t=e.target.value,a=e.target.name;this.setValue(this.state.newCoop,a,t)}},{key:"handleTypeChange",value:function(e){e.target.value,e.target.name;this.setState({newCoop:Object(d.a)({},this.state.newCoop,{types:[{name:e.target.value}]})})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("form",{className:"container-fluid",onSubmit:this.handleFormSubmit},r.a.createElement(y.a,{controlId:"formBasicText"},r.a.createElement(O,{inputType:"text",title:"Name",name:"name",value:this.state.newCoop.name,placeholder:"Enter cooperative name",handleChange:this.handleInput})," ",r.a.createElement(O,{inputType:"text",title:"Type",name:"types[0].name",value:this.state.newCoop.types[0].name,placeholder:"Enter cooperative type",handleChange:this.handleTypeChange})," ",r.a.createElement(O,{inputType:"text",title:"Street",name:"address.formatted",value:this.state.newCoop.address.formatted,placeholder:"Enter address street",handleChange:this.handleInput})," ",r.a.createElement(O,{inputType:"text",title:"City",name:"address.locality.name",value:this.state.newCoop.address.locality.name,placeholder:"Enter address city",handleChange:this.handleInput})," ",r.a.createElement(j,{title:"Country",name:"address.country",options:this.state.countries,value:this.state.newCoop.address.country,placeholder:"Select Country",handleChange:this.handleInput})," ",r.a.createElement(w,{title:"State",name:"address.locality.state",options:this.state.provinces,value:this.state.newCoop.address.locality.state,placeholder:"Select State",handleChange:this.handleInput})," ",r.a.createElement(O,{inputType:"text",title:"Postal Code",name:"address.locality.postal_code",value:this.state.newCoop.address.locality.postal_code,placeholder:"Enter postal code",handleChange:this.handleInput})," ",r.a.createElement(O,{inputType:"text",title:"Email",name:"email",value:this.state.newCoop.email,placeholder:"Enter email",handleChange:this.handleInput})," ",r.a.createElement(O,{inputType:"text",title:"Phone",name:"phone",value:this.state.newCoop.phone,placeholder:"Enter phone number",handleChange:this.handleInput,errors:this.state.errors})," ",r.a.createElement(O,{inputType:"text",title:"Web Site",name:"web_site",value:this.state.newCoop.web_site,placeholder:"Enter web site",handleChange:this.handleInput})," ",r.a.createElement(T,{action:this.handleFormSubmit,type:"primary",title:"Submit",style:N})," ",r.a.createElement(T,{action:this.handleClearForm,type:"secondary",title:"Clear",style:N})," ")))}},{key:"componentDidMount",value:function(){var e=this,a=[],n=[];fetch(t.REACT_APP_PROXY+"/countries/").then((function(e){return e.json()})).then((function(t){a=t.map((function(e){return e})),e.setState({countries:a})})),fetch(t.REACT_APP_PROXY+"/states/"+t.DEFAULT_COUNTRY).then((function(e){return e.json()})).then((function(t){n=t.map((function(e){return e})),e.setState({provinces:n})}))}}]),t}(n.Component);S.DEFAULT_COUNTRY=484,S.REACT_APP_PROXY="http://lab.chicommons.coop";var N={margin:"10px 10px 10px 10px"},k=S,x=function(e){function t(){return Object(i.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement(k,null)}}]),t}(n.Component),R=(a(55),a(40)),_=a(20),P=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).doSearch=function(e){var t="/coops/?contains="+encodeURIComponent(e);fetch(t,{method:"GET"}).then((function(e){return e.json()})).then((function(t){console.log("query:"+e+" searchterm:"+a.state.searchTerm),console.log(t),e===a.state.searchTerm&&a.setState({searchResults:t,loading:!1})}))},a.renderSearchResults=function(){var e=a.state.searchResults;if(e&&e.length)return r.a.createElement("div",null,r.a.createElement("div",null,"Results"),r.a.createElement(R.a,{variant:"flush"},e.map((function(e){return r.a.createElement(_.a,{key:e.id,value:e.name},e.name)}))))},a.state={searchTerm:"",setSearchTerm:"",searchResults:[],setSearchResults:[]},a.handleChange=a.handleChange.bind(Object(E.a)(a)),a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"handleChange",value:function(e){var t=this,a=e.target.value;a?this.setState({searchTerm:a,loading:!0},(function(){t.doSearch(a)})):this.setState({searchTerm:a,searchResults:[]})}},{key:"render",value:function(){return r.a.createElement("div",{className:"searchForm"},r.a.createElement("input",{type:"text",placeholder:"Search",value:this.state.searchTerm,onChange:this.handleChange}),this.renderSearchResults())}}]),t}(n.Component),A=a(21),F=a(36),I=new(a.n(F).a),Y=(a(56),function(){var e=Object(n.useState)(!1),t=Object(A.a)(e,2),a=t[0],l=t[1],s=Object(n.useState)(""),o=Object(A.a)(s,2),c=o[0],i=o[1],u=Object(n.useState)(""),h=Object(A.a)(u,2),m=h[0],p=h[1];return Object(n.useEffect)((function(){I.addListener("flash",(function(e){var t=e.message,a=e.type;l(!0),i(t),p(a),setTimeout((function(){l(!1)}),4e3)}))}),[]),Object(n.useEffect)((function(){null!==document.querySelector(".close")&&document.querySelector(".close").addEventListener("click",(function(){return l(!1)}))})),a&&r.a.createElement("div",{className:"alert alert-".concat(m)},r.a.createElement("span",{className:"close"},r.a.createElement("strong",null,"X")),r.a.createElement("p",null,c))});window.flash=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";return I.emit("flash",{message:e,type:t})};var U=function(){return r.a.createElement(o.a,null,r.a.createElement("div",{className:"App"},r.a.createElement(Y,null),r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light fixed-top"},r.a.createElement("div",{className:"container"},r.a.createElement(o.b,{className:"navbar-brand",to:"/add"},"Chicommons"),r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarTogglerDemo02"},r.a.createElement("ul",{className:"navbar-nav ml-auto"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{className:"nav-link",to:"/add"},"Add")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(o.b,{className:"nav-link",to:"/search"},"Search")))))),r.a.createElement("div",{className:"auth-wrapper"},r.a.createElement("div",{className:"auth-inner"},r.a.createElement(c.c,null,r.a.createElement(c.a,{exact:!0,path:"/",component:x}),r.a.createElement(c.a,{path:"/add",component:x}),r.a.createElement(c.a,{path:"/search",component:P}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(o.a,null,r.a.createElement(U,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[44,1,2]]]);
//# sourceMappingURL=main.312f8919.chunk.js.map